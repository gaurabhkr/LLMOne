<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>LLMOne Chat Interface</title>
    <script src="https://cdn.jsdelivr.net/npm/@tailwindcss/browser@4"></script>
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        * {
            font-family: 'Inter', sans-serif;
            -webkit-tap-highlight-color: transparent;
        }

        .light-scrollbar::-webkit-scrollbar {
            width: 6px;
            height: 6px;
        }

        .light-scrollbar::-webkit-scrollbar-track {
            background: #e5e7eb;
            border-radius: 3px;
        }

        .light-scrollbar::-webkit-scrollbar-thumb {
            background: #9ca3af;
            border-radius: 3px;
        }

        .light-scrollbar::-webkit-scrollbar-thumb:hover {
            background: #6b7280;
        }

        .dark-scrollbar::-webkit-scrollbar {
            width: 6px;
            height: 6px;
        }

        .dark-scrollbar::-webkit-scrollbar-track {
            background: #1f2937;
            border-radius: 3px;
        }

        .dark-scrollbar::-webkit-scrollbar-thumb {
            background: #4b5563;
            border-radius: 3px;
        }

        .dark-scrollbar::-webkit-scrollbar-thumb:hover {
            background: #6b7280;
        }

        .scrollbar-thin::-webkit-scrollbar {
            width: 4px;
            height: 4px;
        }

        @keyframes pulse-dot {

            0%,
            100% {
                opacity: 0.4;
            }

            50% {
                opacity: 1;
            }
        }

        .typing-dot {
            animation: pulse-dot 1.4s infinite;
        }

        .typing-dot:nth-child(2) {
            animation-delay: 0.2s;
        }

        .typing-dot:nth-child(3) {
            animation-delay: 0.4s;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(10px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .fade-in {
            animation: fadeIn 0.3s ease-out;
        }

        .theme-transition {
            transition: background-color 0.3s ease, color 0.3s ease, border-color 0.3s ease;
        }

        @media (max-width: 640px) {
            .mobile-safe-bottom {
                padding-bottom: env(safe-area-inset-bottom, 16px);
            }
        }

        /* Doodle background pattern */
        .doodle-bg-light {
            background-color: #f9fafb;
            background-image: url("data:image/svg+xml,%3Csvg width='60' height='60' viewBox='0 0 60 60' xmlns='http://www.w3.org/2000/svg'%3E%3Cg fill='none' fill-rule='evenodd'%3E%3Cg fill='%239CA3AF' fill-opacity='0.15'%3E%3Cpath d='M36 34v-4h-2v4h-4v2h4v4h2v-4h4v-2h-4zm0-30V0h-2v4h-4v2h4v4h2V6h4V4h-4zM6 34v-4H4v4H0v2h4v4h2v-4h4v-2H6zM6 4V0H4v4H0v2h4v4h2V6h4V4H6z'/%3E%3C/g%3E%3C/g%3E%3C/svg%3E");
        }

        .doodle-bg-dark {
            background-color: #111827;
            background-image: url("data:image/svg+xml,%3Csvg width='60' height='60' viewBox='0 0 60 60' xmlns='http://www.w3.org/2000/svg'%3E%3Cg fill='none' fill-rule='evenodd'%3E%3Cg fill='%234B5563' fill-opacity='0.2'%3E%3Cpath d='M36 34v-4h-2v4h-4v2h4v4h2v-4h4v-2h-4zm0-30V0h-2v4h-4v2h4v4h2V6h4V4h-4zM6 34v-4H4v4H0v2h4v4h2v-4h4v-2H6zM6 4V0H4v4H0v2h4v4h2V6h4V4H6z'/%3E%3C/g%3E%3C/g%3E%3C/svg%3E"),
                url("data:image/svg+xml,%3Csvg width='80' height='80' viewBox='0 0 80 80' xmlns='http://www.w3.org/2000/svg'%3E%3Cg fill='none' fill-rule='evenodd'%3E%3Cg fill='%236366F1' fill-opacity='0.05'%3E%3Ccircle cx='40' cy='40' r='4'/%3E%3C/g%3E%3C/g%3E%3C/svg%3E");
        }

        /* Loading animation */
        @keyframes spin {
            to {
                transform: rotate(360deg);
            }
        }

        @keyframes bounce-loader {

            0%,
            100% {
                transform: translateY(0);
            }

            50% {
                transform: translateY(-10px);
            }
        }

        @keyframes pulse {

            0%,
            100% {
                opacity: 1;
                transform: scale(1);
            }

            50% {
                opacity: 0.7;
                transform: scale(0.95);
            }
        }

        @keyframes shimmer {
            0% {
                background-position: -200% 0;
            }

            100% {
                background-position: 200% 0;
            }
        }

        .loading-spinner {
            animation: spin 1s linear infinite;
        }

        .loading-bounce {
            animation: bounce-loader 1s ease-in-out infinite;
        }

        .loading-pulse {
            animation: pulse 2s ease-in-out infinite;
        }

        .shimmer {
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.4), transparent);
            background-size: 200% 100%;
            animation: shimmer 1.5s infinite;
        }

        /* Float animation for doodles */
        @keyframes float {

            0%,
            100% {
                transform: translateY(0) rotate(0deg);
            }

            50% {
                transform: translateY(-20px) rotate(5deg);
            }
        }

        .float-1 {
            animation: float 6s ease-in-out infinite;
        }

        .float-2 {
            animation: float 8s ease-in-out infinite;
            animation-delay: -2s;
        }

        .float-3 {
            animation: float 7s ease-in-out infinite;
            animation-delay: -4s;
        }

        /* AI Model Icon Bounce Animation */
        @keyframes bounce-icon {
            0% {
                transform: translateY(0);
            }

            25% {
                transform: translateY(-6px);
            }

            50% {
                transform: translateY(0);
            }

            75% {
                transform: translateY(-3px);
            }

            100% {
                transform: translateY(0);
            }
        }

        .model-icon-wrapper {
            transition: filter 0.3s ease, transform 0.3s ease;
            cursor: pointer;
        }

        .model-icon-wrapper:hover {
            filter: brightness(1.3) drop-shadow(0 0 8px rgba(255, 255, 255, 0.6));
            animation: bounce-icon 0.6s ease;
        }

        .avatar-icon-wrapper {
            transition: filter 0.3s ease, transform 0.3s ease;
            cursor: pointer;
        }

        .avatar-icon-wrapper:hover {
            filter: brightness(1.3) drop-shadow(0 0 8px rgba(255, 255, 255, 0.6));
            animation: bounce-icon 0.6s ease;
        }

        .model-button-selected {
            box-shadow: 0 0 20px rgba(99, 102, 241, 0.4);
        }

        .welcome-icon-wrapper {
            transition: filter 0.3s ease, transform 0.3s ease;
            cursor: pointer;
        }

        .welcome-icon-wrapper:hover {
            filter: brightness(1.3) drop-shadow(0 0 12px rgba(255, 255, 255, 0.7));
            animation: bounce-icon 0.6s ease;
        }

        /* Header logo animation */
        .header-logo-wrapper {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            width: 44px;
            height: 44px;
            background: rgb(70, 90, 93);
            border-radius: 15%;
            color: rgb(255, 255, 255);
            transition: transform 0.3s ease, filter 0.3s ease;
            opacity: 1;
            padding: 8px;
            cursor: pointer;
            flex-shrink: 0;
            text-decoration: none;
        }

        @media (min-width: 640px) {
            .header-logo-wrapper {
                width: 48px;
                height: 48px;
                padding: 10px;
            }
        }

        .header-logo-wrapper:hover {
            transform: translateY(-4px);
            filter: drop-shadow(0 0 8px #ffffff);
        }

        .header-logo-wrapper svg {
            display: block;
            fill: #ffffff !important;
            width: 28px;
            height: 28px;
            color: #ffffff;
        }

        @media (min-width: 640px) {
            .header-logo-wrapper svg {
                width: 32px;
                height: 32px;
            }
        }

        /* Message content HTML styling */
        .message-content p {
            margin-bottom: 0.75rem;
        }

        .message-content p:last-child {
            margin-bottom: 0;
        }

        .message-content ul,
        .message-content ol {
            margin: 0.75rem 0;
            padding-left: 1.5rem;
        }

        .message-content ul {
            list-style-type: disc;
        }

        .message-content ol {
            list-style-type: decimal;
        }

        .message-content li {
            margin-bottom: 0.25rem;
        }

        .message-content h1,
        .message-content h2,
        .message-content h3,
        .message-content h4 {
            font-weight: 600;
            margin: 1rem 0 0.5rem 0;
        }

        .message-content h1 {
            font-size: 1.5rem;
        }

        .message-content h2 {
            font-size: 1.25rem;
        }

        .message-content h3 {
            font-size: 1.125rem;
        }

        .message-content h4 {
            font-size: 1rem;
        }

        .message-content pre {
            background: #1f2937;
            border-radius: 0.5rem;
            padding: 1rem;
            overflow-x: auto;
            margin: 0.75rem 0;
        }

        .message-content code {
            font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;
            font-size: 0.875rem;
            color: #e5e7eb;
        }

        .message-content :not(pre)>code {
            background: rgba(99, 102, 241, 0.2);
            padding: 0.125rem 0.375rem;
            border-radius: 0.25rem;
            color: inherit;
        }

        .message-content blockquote {
            border-left: 4px solid #6366f1;
            padding-left: 1rem;
            margin: 0.75rem 0;
            font-style: italic;
            opacity: 0.9;
        }

        .message-content a {
            color: #60a5fa;
            text-decoration: underline;
        }

        .message-content a:hover {
            color: #93c5fd;
        }

        .message-content table {
            width: 100%;
            border-collapse: collapse;
            margin: 0.75rem 0;
        }

        .message-content th,
        .message-content td {
            border: 1px solid #4b5563;
            padding: 0.5rem;
            text-align: left;
        }

        .message-content th {
            background: rgba(99, 102, 241, 0.2);
            font-weight: 600;
        }

        .message-content strong,
        .message-content b {
            font-weight: 600;
        }

        .message-content em,
        .message-content i {
            font-style: italic;
        }
    </style>
</head>

<body class="min-h-screen">
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useRef, useEffect } = React;

        // OpenAI Logo
        const OpenAILogo = ({ className }) => (
            <svg className={className} viewBox="0 0 24 24" fill="currentColor">
                <path d="M22.2819 9.8211a5.9847 5.9847 0 0 0-.5157-4.9108 6.0462 6.0462 0 0 0-6.5098-2.9A6.0651 6.0651 0 0 0 4.9807 4.1818a5.9847 5.9847 0 0 0-3.9977 2.9 6.0462 6.0462 0 0 0 .7427 7.0966 5.98 5.98 0 0 0 .511 4.9107 6.051 6.051 0 0 0 6.5146 2.9001A5.9847 5.9847 0 0 0 13.2599 24a6.0557 6.0557 0 0 0 5.7718-4.2058 5.9894 5.9894 0 0 0 3.9977-2.9001 6.0557 6.0557 0 0 0-.7475-7.0729zm-9.022 12.6081a4.4755 4.4755 0 0 1-2.8764-1.0408l.1419-.0804 4.7783-2.7582a.7948.7948 0 0 0 .3927-.6813v-6.7369l2.02 1.1686a.071.071 0 0 1 .038.052v5.5826a4.504 4.504 0 0 1-4.4945 4.4944zm-9.6607-4.1254a4.4708 4.4708 0 0 1-.5346-3.0137l.142.0852 4.783 2.7582a.7712.7712 0 0 0 .7806 0l5.8428-3.3685v2.3324a.0804.0804 0 0 1-.0332.0615L9.74 19.9502a4.4992 4.4992 0 0 1-6.1408-1.6464zM2.3408 7.8956a4.485 4.485 0 0 1 2.3655-1.9728V11.6a.7664.7664 0 0 0 .3879.6765l5.8144 3.3543-2.0201 1.1685a.0757.0757 0 0 1-.071 0l-4.8303-2.7865A4.504 4.504 0 0 1 2.3408 7.8956zm16.5963 3.8558L13.1038 8.364l2.0201-1.1638a.0757.0757 0 0 1 .071 0l4.8303 2.7913a4.4944 4.4944 0 0 1-.6765 8.1042v-5.6772a.79.79 0 0 0-.4066-.6898zm2.0107-3.0231l-.142-.0852-4.7735-2.7818a.7759.7759 0 0 0-.7854 0L9.409 9.2297V6.8974a.0662.0662 0 0 1 .0284-.0615l4.8303-2.7866a4.4992 4.4992 0 0 1 6.6802 4.66zM8.3065 12.863l-2.02-1.1638a.0804.0804 0 0 1-.038-.0567V6.0742a4.4992 4.4992 0 0 1 7.3757-3.4537l-.142.0805L8.704 5.459a.7948.7948 0 0 0-.3927.6813zm1.0976-2.3654l2.602-1.4998 2.6069 1.4998v2.9994l-2.5974 1.4997-2.6067-1.4997Z" />
            </svg>
        );

        // Mistral AI Logo
        const MistralLogo = ({ className }) => (
            <svg className={className} viewBox="0 0 256 233" xmlns="http://www.w3.org/2000/svg">
                <path fill="#000000" d="M186.182 0h46.545v46.545h-46.545z" />
                <path fill="#F7D046" d="M209.455 0H256v46.545h-46.545z" />
                <path fill="#000000" d="M0 0h46.545v46.545H0zm0 46.545h46.545V93.09H0zm0 46.546h46.545v46.545H0zm0 46.545h46.545v46.545H0zm0 46.546h46.545v46.545H0z" />
                <path fill="#F7D046" d="M23.273 0h46.545v46.545H23.273z" />
                <path fill="#F2A73B" d="M209.455 46.545H256V93.09h-46.545zm-186.182 0h46.545V93.09H23.273z" />
                <path fill="#000000" d="M139.636 46.545h46.545V93.09h-46.545z" />
                <path fill="#F2A73B" d="M162.909 46.545h46.545V93.09h-46.545zm-93.091 0h46.545V93.09H69.818z" />
                <path fill="#EE792F" d="M116.364 93.091h46.545v46.545h-46.545zm46.545 0h46.545v46.545h-46.545zm-93.091 0h46.545v46.545H69.818z" />
                <path fill="#000000" d="M93.091 139.636h46.545v46.545H93.091z" />
                <path fill="#EB5829" d="M116.364 139.636h46.545v46.545h-46.545z" />
                <path fill="#EE792F" d="M209.455 93.091H256v46.545h-46.545zm-186.182 0h46.545v46.545H23.273z" />
                <path fill="#000000" d="M186.182 139.636h46.545v46.545h-46.545z" />
                <path fill="#EB5829" d="M209.455 139.636H256v46.545h-46.545z" />
                <path fill="#000000" d="M186.182 186.182h46.545v46.545h-46.545z" />
                <path fill="#EB5829" d="M23.273 139.636h46.545v46.545H23.273z" />
                <path fill="#EA3326" d="M209.455 186.182H256v46.545h-46.545zm-186.182 0h46.545v46.545H23.273z" />
            </svg>
        );

        // NVIDIA Logo
        const NvidiaLogo = ({ className }) => (
            <svg className={className} viewBox="0 0 16 16" fill="currentColor">
                <path d="M1.635 7.146S3.08 5.012 5.97 4.791v-.774C2.77 4.273 0 6.983 0 6.983s1.57 4.536 5.97 4.952v-.824c-3.23-.406-4.335-3.965-4.335-3.965M5.97 9.475v.753c-2.44-.435-3.118-2.972-3.118-2.972S4.023 5.958 5.97 5.747v.828h-.004c-1.021-.123-1.82.83-1.82.83s.448 1.607 1.824 2.07M6 2l-.03 2.017A7 7 0 0 1 6.252 4c3.637-.123 6.007 2.983 6.007 2.983s-2.722 3.31-5.557 3.31q-.39-.002-.732-.065v.883q.292.039.61.04c2.638 0 4.546-1.348 6.394-2.943.307.246 1.561.842 1.819 1.104-1.757 1.47-5.852 2.657-8.173 2.657a7 7 0 0 1-.65-.034V14H16l.03-12zm-.03 3.747v-.956a6 6 0 0 1 .282-.015c2.616-.082 4.332 2.248 4.332 2.248S8.73 9.598 6.743 9.598c-.286 0-.542-.046-.773-.123v-2.9c1.018.123 1.223.572 1.835 1.593L9.167 7.02s-.994-1.304-2.67-1.304a5 5 0 0 0-.527.031" />
            </svg>
        );

        // DeepSeek Logo
        const DeepSeekLogo = ({ className }) => (
            <svg className={className} viewBox="0 0 24 24" fill="currentColor">
                <path d="M23.748 4.482c-.254-.124-.364.113-.512.234-.051.039-.094.09-.137.136-.372.397-.806.657-1.373.626-.829-.046-1.537.214-2.163.848-.133-.782-.575-1.248-1.247-1.548-.352-.156-.708-.311-.955-.65-.172-.241-.219-.51-.305-.774-.055-.16-.11-.323-.293-.35-.2-.031-.278.136-.356.276-.313.572-.434 1.202-.422 1.84.027 1.436.633 2.58 1.838 3.393.137.093.172.187.129.323-.082.28-.18.552-.266.833-.055.179-.137.217-.329.14a5.526 5.526 0 01-1.736-1.18c-.857-.828-1.631-1.742-2.597-2.458a11.365 11.365 0 00-.689-.471c-.985-.957.13-1.743.388-1.836.27-.098.093-.432-.779-.428-.872.004-1.67.295-2.687.684a3.055 3.055 0 01-.465.137 9.597 9.597 0 00-2.883-.102c-1.885.21-3.39 1.102-4.497 2.623C.082 8.606-.231 10.684.152 12.85c.403 2.284 1.569 4.175 3.36 5.653 1.858 1.533 3.997 2.284 6.438 2.14 1.482-.085 3.133-.284 4.994-1.86.47.234.962.327 1.78.397.63.059 1.236-.03 1.705-.128.735-.156.684-.837.419-.961-2.155-1.004-1.682-.595-2.113-.926 1.096-1.296 2.746-2.642 3.392-7.003.05-.347.007-.565 0-.845-.004-.17.035-.237.23-.256a4.173 4.173 0 001.545-.475c1.396-.763 1.96-2.015 2.093-3.517.02-.23-.004-.467-.247-.588zM11.581 18c-2.089-1.642-3.102-2.183-3.52-2.16-.392.024-.321.471-.235.763.09.288.207.486.371.739.114.167.192.416-.113.603-.673.416-1.842-.14-1.897-.167-1.361-.802-2.5-1.86-3.301-3.307-.774-1.393-1.224-2.887-1.298-4.482-.02-.386.093-.522.477-.592a4.696 4.696 0 011.529-.039c2.132.312 3.946 1.265 5.468 2.774.868.86 1.525 1.887 2.202 2.891.72 1.066 1.494 2.082 2.48 2.914.348.292.625.514.891.677-.802.09-2.14.11-3.054-.614zm1-6.44a.306.306 0 01.415-.287.302.302 0 01.2.288.306.306 0 01-.31.307.303.303 0 01-.304-.308zm3.11 1.596c-.2.081-.399.151-.59.16a1.245 1.245 0 01-.798-.254c-.274-.23-.47-.358-.552-.758a1.73 1.73 0 01.016-.588c.07-.327-.008-.537-.239-.727-.187-.156-.426-.199-.688-.199a.559.559 0 01-.254-.078c-.11-.054-.2-.19-.114-.358.028-.054.16-.186.192-.21.356-.202.767-.136 1.146.016.352.144.618.408 1.001.782.391.451.462.576.685.914.176.265.336.537.445.848.067.195-.019.354-.25.452z" />
            </svg>
        );

        // Icon Components
        const SunIcon = ({ className }) => (
            <svg className={className} fill="none" viewBox="0 0 24 24" stroke="currentColor" strokeWidth={2}>
                <path strokeLinecap="round" strokeLinejoin="round" d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z" />
            </svg>
        );

        const MoonIcon = ({ className }) => (
            <svg className={className} fill="none" viewBox="0 0 24 24" stroke="currentColor" strokeWidth={2}>
                <path strokeLinecap="round" strokeLinejoin="round" d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z" />
            </svg>
        );

        const UserIcon = ({ className }) => (
            <svg className={className} fill="currentColor" viewBox="0 0 24 24">
                <path d="M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z" />
            </svg>
        );

        const SendIcon = ({ className }) => (
            <svg className={className} fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M12 19l9 2-9-18-9 18 9-2zm0 0v-8" />
            </svg>
        );

        const TrashIcon = ({ className }) => (
            <svg className={className} fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16" />
            </svg>
        );

        const CheckIcon = ({ className }) => (
            <svg className={className} fill="currentColor" viewBox="0 0 20 20">
                <path fillRule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clipRule="evenodd" />
            </svg>
        );

        // Model configurations with API endpoints
        const models = [
            {
                id: 'gpt',
                name: 'GPT',
                fullName: 'GPT-OSS-120b',
                endpoint: 'api/gpt',
                color: 'from-emerald-500 to-teal-600',
                bgColor: 'bg-emerald-500/20',
                textColor: 'text-emerald-400',
                IconComponent: OpenAILogo
            },
            {
                id: 'mistral',
                name: 'Devstral',
                fullName: 'Mistral Ai Devstral-2512',
                endpoint: 'api/mistralai',
                color: 'from-orange-500 to-amber-500',
                bgColor: 'bg-orange-500/20',
                textColor: 'text-orange-400',
                IconComponent: MistralLogo
            },
            {
                id: 'nvidia',
                name: 'NVIDIA',
                fullName: 'Nvidia Nemotron-3-nano-30b-a3b',
                endpoint: 'api/nvidia',
                color: 'from-green-600 to-green-400',
                bgColor: 'bg-green-500/20',
                textColor: 'text-green-400',
                IconComponent: NvidiaLogo
            },
            {
                id: 'deepseek',
                name: 'DeepSeek',
                fullName: 'Deepseek-r1t2-Chimera',
                endpoint: 'api/deepseek',
                color: 'from-indigo-500 to-blue-500',
                bgColor: 'bg-indigo-500/20',
                textColor: 'text-indigo-400',
                IconComponent: DeepSeekLogo
            }
        ];

        // Theme Toggle Component
        const ThemeToggle = ({ isDark, onToggle }) => (
            <button
                onClick={onToggle}
                className={`relative w-14 h-7 rounded-full transition-colors duration-300 flex items-center ${isDark ? 'bg-gray-700' : 'bg-blue-100'}`}
                aria-label="Toggle theme"
            >
                <div className={`absolute w-6 h-6 rounded-full transition-all duration-300 flex items-center justify-center ${isDark ? 'translate-x-7 bg-gray-900' : 'translate-x-0.5 bg-yellow-400'}`}>
                    {isDark
                        ? <MoonIcon className="w-4 h-4 text-blue-300" />
                        : <SunIcon className="w-4 h-4 text-yellow-600" />
                    }
                </div>
            </button>
        );

        // Loading Animation Component
        const LoadingAnimation = ({ model, isDark }) => {
            const IconComponent = model.IconComponent;
            return (
                <div className={`flex flex-col items-center gap-4 p-6 rounded-2xl ${isDark ? 'bg-gray-800/80' : 'bg-white/80'} backdrop-blur-sm shadow-lg max-w-xs mx-auto`}>
                    <div className={`relative w-16 h-16 rounded-2xl bg-gradient-to-br ${model.color} flex items-center justify-center p-3 loading-pulse model-icon-wrapper`}>
                        <IconComponent className="w-full h-full text-white" />
                        <div className="absolute inset-0 rounded-2xl shimmer"></div>
                    </div>
                    <div className="flex items-center gap-2">
                        <div className={`w-3 h-3 rounded-full bg-gradient-to-r ${model.color} loading-bounce`} style={{ animationDelay: '0s' }}></div>
                        <div className={`w-3 h-3 rounded-full bg-gradient-to-r ${model.color} loading-bounce`} style={{ animationDelay: '0.2s' }}></div>
                        <div className={`w-3 h-3 rounded-full bg-gradient-to-r ${model.color} loading-bounce`} style={{ animationDelay: '0.4s' }}></div>
                    </div>
                    <p className={`text-sm ${isDark ? 'text-gray-400' : 'text-gray-500'}`}>
                        {model.fullName} is thinking...
                    </p>
                </div>
            );
        };

        // Message Component - with HTML rendering support
        const Message = ({ message, model, isDark }) => {
            const isUser = message.role === 'user';
            const IconComponent = model.IconComponent;

            return (
                <div className={`flex ${isUser ? 'justify-end' : 'justify-start'} mb-3 sm:mb-4`}>
                    <div className={`flex items-start gap-2 sm:gap-3 max-w-[90%] sm:max-w-[85%] md:max-w-[70%] ${isUser ? 'flex-row-reverse' : ''}`}>
                        <div className={`flex-shrink-0 w-8 h-8 sm:w-10 sm:h-10 rounded-full flex items-center justify-center p-1.5 sm:p-2 avatar-icon-wrapper ${isUser ? 'bg-gradient-to-br from-sky-400 to-blue-500' : `bg-gradient-to-br ${model.color}`}`}>
                            {isUser
                                ? <UserIcon className="w-full h-full text-white" />
                                : <IconComponent className="w-full h-full text-white" />
                            }
                        </div>
                        <div className={`px-4 py-3 sm:px-5 sm:py-4 rounded-2xl ${isUser ? 'bg-gradient-to-br from-sky-400 to-blue-500 text-white' : isDark ? 'bg-gray-800 text-gray-100' : 'bg-white text-gray-800 shadow-md border border-gray-200'}`}>
                            {isUser ? (
                                <p className="text-sm sm:text-base whitespace-pre-wrap break-words leading-relaxed">{message.content}</p>
                            ) : (
                                <div
                                    className="text-sm sm:text-base break-words leading-relaxed message-content"
                                    dangerouslySetInnerHTML={{ __html: message.content }}
                                />
                            )}
                            <span className={`text-xs mt-2 block ${isUser ? 'text-sky-100' : isDark ? 'text-gray-500' : 'text-gray-400'}`}>{message.time}</span>
                        </div>
                    </div>
                </div>
            );
        };

        // Model Selector Component
        const ModelSelector = ({ selectedModel, onSelectModel, isDark }) => (
            <div className="flex flex-wrap gap-2 sm:gap-3 justify-center">
                {models.map(model => {
                    const IconComponent = model.IconComponent;
                    const isSelected = selectedModel.id === model.id;
                    return (
                        <button
                            key={model.id}
                            onClick={() => onSelectModel(model)}
                            className={`flex items-center gap-2 px-3 py-2 sm:px-4 sm:py-2.5 rounded-xl transition-all duration-300 ${isSelected
                                    ? `bg-gradient-to-r ${model.color} text-white shadow-lg scale-105 model-button-selected`
                                    : isDark
                                        ? 'bg-gray-800 hover:bg-gray-700 text-gray-300 border border-gray-700'
                                        : 'bg-white hover:bg-gray-50 text-gray-700 border border-gray-200 shadow-sm'
                                }`}
                        >
                            <div className={`w-6 h-6 sm:w-7 sm:h-7 rounded-lg flex items-center justify-center p-1 model-icon-wrapper ${isSelected ? 'bg-white/20' : `bg-gradient-to-br ${model.color}`}`}>
                                <IconComponent className="w-full h-full text-white" />
                            </div>
                            <span className="font-medium text-sm sm:text-base">{model.name}</span>
                            {isSelected && <CheckIcon className="w-4 h-4 sm:w-5 sm:h-5" />}
                        </button>
                    );
                })}
            </div>
        );

        // Floating Doodle Elements
        const FloatingDoodles = ({ isDark }) => (
            <div className="fixed inset-0 pointer-events-none overflow-hidden z-0">
                <div className={`absolute top-20 left-10 w-16 h-16 rounded-full ${isDark ? 'bg-purple-500/10' : 'bg-purple-300/20'} float-1`}></div>
                <div className={`absolute top-40 right-20 w-24 h-24 rounded-full ${isDark ? 'bg-blue-500/10' : 'bg-blue-300/20'} float-2`}></div>
                <div className={`absolute bottom-40 left-20 w-20 h-20 rounded-full ${isDark ? 'bg-green-500/10' : 'bg-green-300/20'} float-3`}></div>
                <div className={`absolute bottom-20 right-10 w-12 h-12 rounded-full ${isDark ? 'bg-pink-500/10' : 'bg-pink-300/20'} float-1`}></div>
                <div className={`absolute top-1/2 left-1/4 w-8 h-8 rounded-full ${isDark ? 'bg-yellow-500/10' : 'bg-yellow-300/20'} float-2`}></div>
                <div className={`absolute top-1/3 right-1/4 w-14 h-14 rounded-full ${isDark ? 'bg-cyan-500/10' : 'bg-cyan-300/20'} float-3`}></div>
            </div>
        );

        // Main App Component
        const App = () => {
            const [selectedModel, setSelectedModel] = useState(models[0]);
            const [messages, setMessages] = useState([]);
            const [inputValue, setInputValue] = useState('');
            const [isLoading, setIsLoading] = useState(false);
            const [isDark, setIsDark] = useState(() => {
                const saved = localStorage.getItem('theme');
                return saved ? saved === 'dark' : true;
            });
            const messagesEndRef = useRef(null);
            const inputRef = useRef(null);

            useEffect(() => {
                localStorage.setItem('theme', isDark ? 'dark' : 'light');
            }, [isDark]);

            const scrollToBottom = () => {
                messagesEndRef.current?.scrollIntoView({ behavior: 'smooth' });
            };

            useEffect(() => {
                scrollToBottom();
            }, [messages, isLoading]);

            const getCurrentTime = () => {
                return new Date().toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });
            };

            const sendMessage = async () => {
                if (!inputValue.trim() || isLoading) return;

                const userMessage = {
                    role: 'user',
                    content: inputValue.trim(),
                    time: getCurrentTime()
                };

                setMessages(prev => [...prev, userMessage]);
                setInputValue('');
                setIsLoading(true);

                if (inputRef.current) {
                    inputRef.current.focus();
                }

                try {
                    const encodedMessage = encodeURIComponent(userMessage.content);
                    const response = await fetch(`${selectedModel.endpoint}/${encodedMessage}`);

                    if (!response.ok) {
                        throw new Error('Failed to get response');
                    }

                    const data = await response.text();

                    const assistantMessage = {
                        role: 'assistant',
                        content: data || '<p>Sorry, I could not generate a response.</p>',
                        time: getCurrentTime(),
                        model: selectedModel.id
                    };

                    setMessages(prev => [...prev, assistantMessage]);
                } catch (error) {
                    console.error('Error:', error);
                    const errorMessage = {
                        role: 'assistant',
                        content: `<p><strong>Error:</strong> Could not connect to ${selectedModel.fullName}. Please check if the server is running.</p>`,
                        time: getCurrentTime(),
                        model: selectedModel.id
                    };
                    setMessages(prev => [...prev, errorMessage]);
                } finally {
                    setIsLoading(false);
                }
            };

            const handleKeyPress = (e) => {
                if (e.key === 'Enter' && !e.shiftKey) {
                    e.preventDefault();
                    sendMessage();
                }
            };

            const clearChat = () => {
                setMessages([]);
            };

            const toggleTheme = () => {
                setIsDark(prev => !prev);
            };

            const IconComponent = selectedModel.IconComponent;

            return (
                <div className={`min-h-screen flex flex-col theme-transition ${isDark ? 'doodle-bg-dark' : 'doodle-bg-light'}`}>
                    {/* Floating Doodles */}
                    <FloatingDoodles isDark={isDark} />

                    {/* Header */}
                    <header className={`sticky top-0 z-20 theme-transition border-b px-4 py-3 sm:px-6 sm:py-4 ${isDark
                            ? 'bg-gray-900/80 border-gray-700'
                            : 'bg-white/80 border-gray-200'
                        } backdrop-blur-xl`}>
                        <div className="max-w-5xl mx-auto">
                            {/* Top row */}
                            <div className="flex items-center justify-between mb-4">
                                <div className="flex items-center gap-3">
                                    <a href="#" onClick={(e) => { e.preventDefault(); window.location.reload(); }} className="header-logo-wrapper" aria-label="LLMOne Chat Logo - Click to refresh">
                                        <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" style={{ display: 'block', fill: '#ffffff', width: '100%', height: '100%' }}>
                                            <title>LLMOne Chat</title>
                                            <path d="M5.042 15.165a2.528 2.528 0 0 1-2.52 2.523A2.528 2.528 0 0 1 0 15.165a2.527 2.527 0 0 1 2.522-2.52h2.52v2.52zM6.313 15.165a2.527 2.527 0 0 1 2.521-2.52 2.527 2.527 0 0 1 2.521 2.52v6.313A2.528 2.528 0 0 1 8.834 24a2.528 2.528 0 0 1-2.521-2.522v-6.313zM8.834 5.042a2.528 2.528 0 0 1-2.521-2.52A2.528 2.528 0 0 1 8.834 0a2.528 2.528 0 0 1 2.521 2.522v2.52H8.834zM8.834 6.313a2.528 2.528 0 0 1 2.521 2.521 2.528 2.528 0 0 1-2.521 2.521H2.522A2.528 2.528 0 0 1 0 8.834a2.528 2.528 0 0 1 2.522-2.521h6.312zM18.956 8.834a2.528 2.528 0 0 1 2.522-2.521A2.528 2.528 0 0 1 24 8.834a2.528 2.528 0 0 1-2.522 2.521h-2.522V8.834zM17.688 8.834a2.528 2.528 0 0 1-2.523 2.521 2.527 2.527 0 0 1-2.52-2.521V2.522A2.527 2.527 0 0 1 15.165 0a2.528 2.528 0 0 1 2.523 2.522v6.312zM15.165 18.956a2.528 2.528 0 0 1 2.523 2.522A2.528 2.528 0 0 1 15.165 24a2.527 2.527 0 0 1-2.52-2.522v-2.522h2.52zM15.165 17.688a2.527 2.527 0 0 1-2.52-2.523 2.526 2.526 0 0 1 2.52-2.52h6.313A2.527 2.527 0 0 1 24 15.165a2.528 2.528 0 0 1-2.522 2.523h-6.313z" fill="#ffffff" />
                                        </svg>
                                    </a>
                                    <div>
                                        <h1 className={`font-bold text-lg sm:text-xl ${isDark ? 'text-white' : 'text-gray-900'}`}>LLMOne Chat</h1>
                                        <p className={`text-xs sm:text-sm ${isDark ? 'text-gray-400' : 'text-gray-500'}`}>Choose your AI assistant</p>
                                    </div>
                                </div>
                                <div className="flex items-center gap-2 sm:gap-3">
                                    <button
                                        onClick={clearChat}
                                        className={`p-2 rounded-lg transition-colors ${isDark
                                                ? 'text-gray-400 hover:text-white hover:bg-gray-700'
                                                : 'text-gray-500 hover:text-gray-900 hover:bg-gray-100'
                                            }`}
                                        title="Clear chat"
                                    >
                                        <TrashIcon className="w-5 h-5" />
                                    </button>
                                    <ThemeToggle isDark={isDark} onToggle={toggleTheme} />
                                </div>
                            </div>

                            {/* Model selector */}
                            <ModelSelector
                                selectedModel={selectedModel}
                                onSelectModel={setSelectedModel}
                                isDark={isDark}
                            />
                        </div>
                    </header>

                    {/* Messages */}
                    <main className={`flex-1 overflow-y-auto p-4 sm:p-6 ${isDark ? 'dark-scrollbar' : 'light-scrollbar'} relative z-10`}>
                        <div className="max-w-4xl mx-auto">
                            {messages.length === 0 ? (
                                <div className="h-full min-h-[50vh] flex flex-col items-center justify-center text-center px-4 fade-in">
                                    <div className={`w-20 h-20 sm:w-24 sm:h-24 rounded-3xl bg-gradient-to-br ${selectedModel.color} flex items-center justify-center mb-6 p-4 sm:p-5 shadow-2xl welcome-icon-wrapper`}>
                                        <IconComponent className="w-full h-full text-white" />
                                    </div>
                                    <h3 className={`text-xl sm:text-2xl font-bold mb-3 ${isDark ? 'text-white' : 'text-gray-900'}`}>
                                        Chat with {selectedModel.fullName}
                                    </h3>
                                    <p className={`text-sm sm:text-base max-w-md mb-6 ${isDark ? 'text-gray-400' : 'text-gray-500'}`}>
                                        Start a conversation below. Switch between AI models anytime using the buttons above.
                                    </p>
                                    <div className="flex flex-wrap gap-2 sm:gap-3 justify-center max-w-lg">
                                        {['Explain quantum computing', 'Write a poem', 'Help me code', 'Tell me a joke'].map((prompt) => (
                                            <button
                                                key={prompt}
                                                onClick={() => setInputValue(prompt)}
                                                className={`px-4 py-2 rounded-full text-sm transition-all hover:scale-105 ${isDark
                                                        ? 'bg-gray-800 hover:bg-gray-700 text-gray-300 border border-gray-700'
                                                        : 'bg-white hover:bg-gray-50 text-gray-600 shadow-md border border-gray-200'
                                                    }`}
                                            >
                                                {prompt}
                                            </button>
                                        ))}
                                    </div>
                                </div>
                            ) : (
                                <>
                                    {messages.map((message, index) => (
                                        <div key={index} className="fade-in">
                                            <Message
                                                message={message}
                                                model={models.find(m => m.id === message.model) || selectedModel}
                                                isDark={isDark}
                                            />
                                        </div>
                                    ))}
                                    {isLoading && (
                                        <div className="fade-in my-6">
                                            <LoadingAnimation model={selectedModel} isDark={isDark} />
                                        </div>
                                    )}
                                    <div ref={messagesEndRef} />
                                </>
                            )}
                        </div>
                    </main>

                    {/* Input */}
                    <footer className={`sticky bottom-0 z-20 p-4 sm:p-6 theme-transition border-t mobile-safe-bottom ${isDark
                            ? 'bg-gray-900/80 border-gray-700'
                            : 'bg-white/80 border-gray-200'
                        } backdrop-blur-xl`}>
                        <div className="max-w-4xl mx-auto">
                            <div className="flex gap-3 items-end">
                                <div className="flex-1 relative">
                                    <textarea
                                        ref={inputRef}
                                        value={inputValue}
                                        onChange={(e) => setInputValue(e.target.value)}
                                        onKeyPress={handleKeyPress}
                                        placeholder={`Message ${selectedModel.name}...`}
                                        rows={1}
                                        className={`w-full px-4 py-3 sm:px-5 sm:py-4 rounded-2xl text-sm sm:text-base focus:outline-none focus:ring-2 focus:ring-indigo-500 resize-none theme-transition ${isDark
                                                ? 'bg-gray-800 border-gray-600 text-white placeholder-gray-400'
                                                : 'bg-gray-100 border-gray-200 text-gray-900 placeholder-gray-500'
                                            } border`}
                                        style={{ minHeight: '52px', maxHeight: '150px' }}
                                        disabled={isLoading}
                                    />
                                </div>
                                <button
                                    onClick={sendMessage}
                                    disabled={!inputValue.trim() || isLoading}
                                    className={`p-3 sm:p-4 rounded-2xl transition-all duration-300 flex-shrink-0 ${inputValue.trim() && !isLoading
                                            ? `bg-gradient-to-r ${selectedModel.color} text-white shadow-lg hover:shadow-xl hover:scale-105 active:scale-95`
                                            : isDark
                                                ? 'bg-gray-700 text-gray-500 cursor-not-allowed'
                                                : 'bg-gray-200 text-gray-400 cursor-not-allowed'
                                        }`}
                                >
                                    {isLoading
                                        ? <div className="w-5 h-5 sm:w-6 sm:h-6 border-2 border-white/30 border-t-white rounded-full loading-spinner"></div>
                                        : <SendIcon className="w-5 h-5 sm:w-6 sm:h-6" />
                                    }
                                </button>
                            </div>
                            <p className={`text-center text-xs mt-3 ${isDark ? 'text-gray-500' : 'text-gray-400'}`}>
                                Press Enter to send â€¢ Shift+Enter for new line
                            </p>
                        </div>
                    </footer>
                </div>
            );
        };

        ReactDOM.createRoot(document.getElementById('root')).render(<App />);
    </script>
</body>

</html>